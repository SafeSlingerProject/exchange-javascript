var SafeSlinger=function(){function a(a,b,c,d){var e=str2bigInt(b.toString(),16,1536),f=str2bigInt(c.toString(),16,1536),g=new h.DiffieHellman,i=g.computeSecret(e,f);a.groupKey=CryptoJS.enc.Hex.parse(bigInt2str(i,16)),console.log("Group Secret Key: "+a.groupKey),a.keyNodeSet[d]=CryptoJS.enc.Hex.parse(bigInt2str(g.publicKey,16))}function b(a){a.encMatchNonceSet[a.userID]=f(a.matchNonce,a.groupKey),console.log("Encrypted Match Nonce: "+a.encMatchNonceSet[a.userID]),a.syncMatchRequest(function(b){a.syncMatch(b)})}function c(a){return 0===a?0:1===a?1:c(a-1)+c(a-2)}function d(a){return CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Utf8.parse("1"))+CryptoJS.enc.Latin1.stringify(a)),{outputLength:256})}function e(a){var b=CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(CryptoJS.enc.Latin1.stringify(CryptoJS.enc.Utf8.parse("2"))+CryptoJS.enc.Latin1.stringify(a)),{outputLength:256}),c=CryptoJS.enc.Latin1.stringify(b),d=c.substring(0,16);return CryptoJS.enc.Latin1.parse(d)}function f(a,b){return CryptoJS.AES.encrypt(a,d(b),{iv:e(b),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7}).ciphertext}function g(a,b){return CryptoJS.AES.decrypt({ciphertext:a},d(b),{iv:e(b),mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7})}var h={};h.jspack=new JSPack,h.HTTPSConnection=function(a){var b=this;b.address=a,b.connected=!1,b.connection=null,b.version=17301504,""!==b.address&&b.connect()},h.HTTPSConnection.prototype.connect=function(){var a=this,b=new XMLHttpRequest;a.connection=b,a.connected=!0},h.HTTPSConnection.prototype.doPost=function(a,b,c){var d=this;console.log("Connecting to server: "+d.address),d.connection.open("POST",d.address+a,!0),d.connection.responseType="arraybuffer",d.connection.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),d.connection.onload=function(a){var b=d.connection.response;console.log(d.connection),200===d.connection.status?(d.response=b,console.log("response: "+b+" status:"+d.connection.status),c(b)):console.log("Network error: return code"+d.connection.status+", reason = "+d.connection.statusText)},d.connection.send(b)},h.HTTPSConnection.prototype.doPostAjax=function(a,b,c){console.log("JSON data"),console.log(b.ver_client),console.log(b.commit_b64);var d=this;jQuery.ajax({url:d.address+a,type:"POST",processData:!1,dataType:"json",contentType:"text/plain",data:JSON.stringify(b),crossDomain:!0,success:function(a){console.log("success"),console.log(a),c(a)},error:function(a){console.log("error"),console.log(a)}})},h.HTTPSConnection.prototype.assignUser=function(a,b){var c=this;if(!c.connected)return null;console.log("************** HTTP assignUser *******************");var d=h.jspack.Pack("!"+a.length+"B",a);console.log(d);var e=h.util.createBinString(d);console.log("PackLen: "+e.length),console.log(e);var f={ver_client:String(c.version),commit_b64:btoa(e)};c.doPostAjax("/assignUser",f,b)},h.HTTPSConnection.prototype.syncUsers=function(a,b,c,d,e){var f=this;if(!f.connected)return null;console.log("************** HTTP syncUsers *******************"),console.log("dataCommitment"),console.log(d);var g=h.jspack.Pack("!"+d.length+"B",d);console.log("pack"),console.log(g);var i=h.util.createBinString(g);console.log("packBin"),console.log(i),console.log("PackLen: "+i.length);var j={ver_client:String(f.version),usrid:String(a),usridlink:String(b),usrids:c,commit_b64:btoa(i)};f.doPostAjax("/syncUsers",j,e)},h.HTTPSConnection.prototype.syncData=function(a,b,c,d,e,f){var g=this;if(!g.connected)return null;console.log("************** HTTP syncData *******************");var i=b.concat(c).concat(e);console.log("commit"),console.log(i);var j=h.jspack.Pack("!"+i.length+"B",i);console.log("pack"),console.log(j);var k=h.util.createBinString(j);console.log("packBin"),console.log(k),console.log("PackLen: "+k.length);var l={ver_client:String(g.version),usrid:String(a),usrids:d,data_b64:btoa(k)};g.doPostAjax("/syncData",l,f)},h.HTTPSConnection.prototype.syncSignatures=function(a,b,c,d){var e=this;if(!e.connected)return null;console.log("************** HTTP syncSignatures *******************"),console.log("sig"),console.log(c);var f=h.jspack.Pack("!"+c.length+"B",c);console.log("pack"),console.log(f);var g=h.util.createBinString(f);console.log("packBin"),console.log(g),console.log("PackLen: "+g.length);var i={ver_client:String(e.version),usrid:String(a),usrids:b,signature_b64:btoa(g)};e.doPostAjax("/syncSignatures",i,d)},h.HTTPSConnection.prototype.syncKeyNodes=function(a,b,c,d){var e=this;if(!e.connected)return null;console.log("************** HTTP syncKeyNodes *******************");var f={ver_client:String(e.version),usrid:String(a)};if(null!==c){console.log("keynode"),console.log(c);var g=h.jspack.Pack("!"+c.length+"B",c);console.log("pack"),console.log(g);var i=h.util.createBinString(g);console.log("packBin"),console.log(i),console.log("PackLen: "+i.length),f.usridpost=String(b),f.keynode_b64=btoa(i)}e.doPostAjax("/syncKeyNodes",f,d)},h.HTTPSConnection.prototype.syncMatch=function(a,b,c,d){var e=this;if(!e.connected)return null;console.log("************** HTTP syncMatch *******************"),console.log("matchNonce"),console.log(c);var f=h.jspack.Pack("!"+c.length+"B",c);console.log("pack"),console.log(f);var g=h.util.createBinString(f);console.log("packBin"),console.log(g),console.log("PackLen: "+g.length);var i={ver_client:String(e.version),usrid:String(a),usrids:b,matchnonce_b64:btoa(g)};e.doPostAjax("/syncMatch",i,d)},h.SafeSlingerExchange=function(a){var b=this;b.version=17301504,b.address=a,b.httpclient=null,b.data=null,b.matchNonce=null,b.wrongNonce=null,b.matchExtrahash=null,b.matchHash=null,b.encryptedData=null,b.protocolCommitment=null,b.dhkey=null,b.dhpubkey=null,b.dataCommitment=null,b.numUsers=0,b.userID=null,b.correctIndex=-1,b.selectedIndex=-1,b.dhkeyLen=-1,b.groupkey=null,b.hash=null,b.decoy1=null,b.decoy2=null,b.sig=null,b.uidSet=[],b.dataCommitmentSet={},b.protoCommitmentSet={},b.dhpubkeySet={},b.receivedcipherSet={},b.signatureSet={},b.keyNodeSet={},b.encMatchNonceSet={},b.matchNonceSet={},b.dataSet={}},h.SafeSlingerExchange.prototype.beginExchange=function(a){var b=this;b.data=a,console.log("Data: "+b.data),b.matchNonce=CryptoJS.lib.WordArray.random(32),console.log("Match Nonce: "+b.matchNonce),b.wrongNonce=CryptoJS.lib.WordArray.random(32),console.log("Wrong Nonce: "+b.wrongNonce),b.matchExtrahash=CryptoJS.SHA3(b.matchNonce,{outputLength:256}),b.wrongHash=CryptoJS.SHA3(b.wrongNonce,{outputLength:256}),b.matchHash=CryptoJS.SHA3(b.matchExtrahash,{outputLength:256}),console.log("Match Extra Hash: "+b.matchExtrahash),console.log("Match Hash: "+b.matchHash),console.log("Wrong Hash: "+b.wrongHash),b.encryptedData=f(a,b.matchNonce),console.log("Encrypted Data: "+b.encryptedData);var c=CryptoJS.enc.Hex.parse(b.matchHash.toString()+b.wrongHash.toString());console.log("Prot: "+c),b.protocolCommitment=CryptoJS.SHA3(c,{outputLength:256}),console.log("Protocol Commitment: "+b.protocolCommitment),b.dh=new h.DiffieHellman,b.dh.genKeys(),b.dhpubkey=CryptoJS.enc.Hex.parse(bigInt2str(b.dh.publicKey,16)),b.dhkey=CryptoJS.enc.Hex.parse(bigInt2str(b.dh.privateKey,16)),b.dhkeyLen=b.dhkey.length,console.log("DH Public: "+b.dhpubkey),console.log("DH Private: "+b.dhkey);var d=CryptoJS.enc.Hex.parse(b.protocolCommitment.toString()+b.dhpubkey.toString()+b.encryptedData.toString());console.log("Data: "+d),b.dataCommitment=CryptoJS.SHA3(d,{outputLength:256}),console.log("Data Commitment: "+b.dataCommitment),b.httpclient=new h.HTTPSConnection(b.address)},h.SafeSlingerExchange.prototype.assignUserRequest=function(a){var b=this;b.httpclient.assignUser(h.util.parseHexString(b.dataCommitment.toString()),a)},h.SafeSlingerExchange.prototype.assignUser=function(a){var b=this;return console.log("********************** SafeSlinger assignUser ************"),console.log(a),b.userID=a.usrid,b.dataSet[b.userID]=b.data,b.dataCommitmentSet[b.userID]=b.dataCommitment,b.protoCommitmentSet[b.userID]=b.protocolCommitment,b.dhpubkeySet[b.userID]=b.dhpubkey,b.receivedcipherSet[b.userID]=b.encryptedData,console.log("Assigned Id: "+b.userID),console.log(b.dataSet[b.userID].toString()),console.log(b.dataCommitmentSet[b.userID].toString()),console.log(b.protoCommitmentSet[b.userID].toString()),console.log(b.dhpubkeySet[b.userID].toString()),console.log(b.receivedcipherSet[b.userID].toString()),b.userID},h.SafeSlingerExchange.prototype.syncUsersRequest=function(a,b){var c=this;c.attempt=1,c.lowNum=a,c.numUsers_Recv=1,c.uidSet.push(c.userID),console.log(c.uidSet),c.httpclient.syncUsers(c.userID,a,c.uidSet,h.util.parseHexString(c.dataCommitment.toString()),b)},h.SafeSlingerExchange.prototype.syncUsers=function(a){var b=this;console.log("********************** SafeSlinger syncUsers ************"),console.log(a);var d=(a.ver_server,a.ver_low_client,parseInt(a.com_total),a.com_deltas);console.log(d);var e=d.length;if(b.numUsers_Recv<b.numUsers&&e>0){b.offset=16;for(var f=0;f<e;f++){var g=d[f].usrid;b.uidSet.push(g);var i=CryptoJS.enc.Latin1.parse(atob(d[f].commit_b64));b.dataCommitmentSet[g]=i,console.log(g+"'s dataCommitment: "+b.dataCommitmentSet[g]),b.numUsers_Recv++,console.log("Received "+b.numUsers_Recv+"/"+b.numUsers+" Items")}}b.numUsers_Recv<b.numUsers?setTimeout(function(){b.attempt++,b.httpclient.syncUsers(b.userID,b.lowNum,b.uidSet,h.util.parseHexString(b.dataCommitment.toString()),function(a){b.syncUsers(a)})},1e3*c(b.attempt)):(console.log("All commitments received"),console.log(b.dataCommitmentSet),b.syncDataRequest(function(a){b.syncData(a)})),console.log("done")},h.SafeSlingerExchange.prototype.syncDataRequest=function(a){var b=this;b.numData_Recv=1,b.uidSet=[],b.uidSet.push(b.userID);var c=h.util.parseHexString(b.protocolCommitment.toString()),d=h.util.parseHexString(b.dhpubkey.toString()),e=h.util.parseHexString(b.encryptedData.toString());b.httpclient.syncData(b.userID,c,d,b.uidSet,e,a)},h.SafeSlingerExchange.prototype.syncData=function(a){var b=this;console.log("********************** SafeSlinger syncData ************"),console.log(a);var d=(a.ver_server,a.data_total),e=a.data_deltas,f=e.length;if(console.log("data_total --> "+d),console.log("data_deltas --> "+e),console.log("data_counts --> "+f),b.numData_Recv<b.numUsers&&f>0)for(var g=0;g<f;g++){var i=e[g].usrid;b.uidSet.push(i);var j=atob(e[g].data_b64);b.protoCommitmentSet[i]=CryptoJS.enc.Latin1.parse(j.substring(0,32)),b.dhpubkeySet[i]=CryptoJS.enc.Latin1.parse(j.substring(32,224)),b.receivedcipherSet[i]=CryptoJS.enc.Latin1.parse(j.substring(224)),console.log(i+"'s data: "+CryptoJS.enc.Latin1.parse(j)),console.log(i+"'s protoCommitment: "+b.protoCommitmentSet[i]),console.log(i+"'s dhpubkey: "+b.dhpubkeySet[i]),console.log(i+"'s receivedcipher: "+b.receivedcipherSet[i]),console.log(i+"'s data commit: "+b.dataCommitmentSet[i]),console.log(i+"'s data hash: "+CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(j),{outputLength:256})),b.numData_Recv++,console.log("Received "+b.numData_Recv+"/"+b.numUsers+" Items")}if(b.numData_Recv<b.numUsers){var k=h.util.parseHexString(b.protocolCommitment.toString()),l=h.util.parseHexString(b.dhpubkey.toString()),m=h.util.parseHexString(b.encryptedData.toString());setTimeout(function(){b.attempt++,b.httpclient.syncData(b.userID,k,l,b.uidSet,m,function(a){b.syncData(a)})},1e3*c(b.attempt))}else{console.log("All data received"),console.log(b.protoCommitmentSet),console.log(b.dhpubkeySet),console.log(b.receivedcipherSet);var n="";b.uidSet.sort();for(var g=0;g<b.uidSet.length;g++){var i=b.uidSet[g];n+=b.protoCommitmentSet[i].toString(CryptoJS.enc.Latin1),n+=b.dhpubkeySet[i].toString(CryptoJS.enc.Latin1),n+=b.receivedcipherSet[i].toString(CryptoJS.enc.Latin1)}b.hash=CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(n),{outputLength:256}),console.log("Hash: "+b.hash),b.decoy1=CryptoJS.lib.WordArray.random(3),b.decoy2=CryptoJS.lib.WordArray.random(3),b.correctSelection=Math.floor(3*Math.random()+1)}console.log("done")},h.SafeSlingerExchange.prototype.syncSignaturesRequest=function(a,b){var c=this;c.attempt=1,c.numSigs_Recv=1,c.uidSet=[],c.uidSet.push(c.userID),console.log(c.uidSet);var d=null,e=null;null!==a&&a.toString()==c.getHash24Bits().toString()?(c.correctSig=!0,d=c.matchExtrahash,e=c.wrongHash):(c.correctSig=!1,d=c.matchHash,e=c.wrongNonce);var f=CryptoJS.enc.Latin1.parse(d.toString(CryptoJS.enc.Latin1)+e.toString(CryptoJS.enc.Latin1));c.sig=f,console.log("Signature: "+c.sig),c.signatureSet[c.userID]=c.sig,c.httpclient.syncSignatures(c.userID,c.uidSet,h.util.parseHexString(c.sig.toString()),b)},h.SafeSlingerExchange.prototype.syncSignatures=function(a){var b=this;console.log("********************** SafeSlinger syncSignatures ************"),console.log(a);var d=(a.ver_server,parseInt(a.sig_total),a.sig_deltas);console.log(d);var e=d.length;if(b.numSigs_Recv<b.numUsers&&e>0){b.offset=16;for(var f=0;f<e;f++){var g=d[f].usrid;b.uidSet.push(g);var i=CryptoJS.enc.Latin1.parse(atob(d[f].signature_b64));b.signatureSet[g]=i,console.log(g+"'s signature: "+b.signatureSet[g]),console.log(g+"'s protoCommit: "+b.protoCommitmentSet[g]),console.log(g+"'s match sig protoCommit: "+CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(b.signatureSet[g].toString(CryptoJS.enc.Latin1).substring(0,32)),{outputLength:256}).toString(CryptoJS.enc.Latin1)+b.signatureSet[g].toString(CryptoJS.enc.Latin1).substring(32)),{outputLength:256})),console.log(g+"'s wrong sig protoCommit: "+CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(b.signatureSet[g].toString(CryptoJS.enc.Latin1).substring(0,32)+CryptoJS.SHA3(CryptoJS.enc.Latin1.parse(b.signatureSet[g].toString(CryptoJS.enc.Latin1).substring(32)),{outputLength:256}).toString(CryptoJS.enc.Latin1)),{outputLength:256})),b.numSigs_Recv++,console.log("Received "+b.numSigs_Recv+"/"+b.numUsers+" Items")}}if(b.numSigs_Recv<b.numUsers)setTimeout(function(){b.attempt++,b.httpclient.syncSignatures(b.userID,b.uidSet,h.util.parseHexString(b.signatureSet[b.userID].toString()),function(a){b.syncSignatures(a)})},1e3*c(b.attempt));else{if(console.log("All sigs received"),console.log(b.signatureSet),!b.correctSig)return;b.syncKeyNodesRequest(function(a){b.syncKeyNodes(a)})}console.log("done")},h.SafeSlingerExchange.prototype.syncKeyNodesRequest=function(c){var d=this;if(d.nodepos=1,d.uidSet.sort(),d.mypos=d.uidSet.indexOf(d.userID),d.keyNodeBackoffSecs=d.mypos>2?0:1e3,d.mypos<2){var e=0===d.mypos?d.uidSet[1]:d.uidSet[0];a(d,d.dhpubkeySet[e],d.dhkey,e)}d.numUsers>2?(d.attempt=1,d.mypos<2?d.httpclient.syncKeyNodes(d.userID,d.uidSet[d.nodepos+1],h.util.parseHexString(d.keyNodeSet[e].toString()),c):d.httpclient.syncKeyNodes(d.userID,null,null,c)):b(d)},h.SafeSlingerExchange.prototype.syncKeyNodes=function(d){var e=this;console.log("********************** SafeSlinger syncKeyNodes ************"),console.log(d);var f=(d.ver_server,parseInt(d.node_total));if(e.mypos>=2){if(f>0){var g=e.uidSet[e.mypos];e.offset=16;var i=CryptoJS.enc.Latin1.parse(atob(d.keynode_b64));e.keyNodeSet[g]=i,console.log(g+"'s keynode: "+e.keyNodeSet[g]),console.log("Received "+f+"/1 Items"),e.nodepos=e.mypos,a(e,e.keyNodeSet[g],e.dhkey,g);for(var j=e.nodepos;j+1<e.numUsers;j++){e.nodepos++;var g=e.uidSet[e.nodepos];a(e,e.dhpubkeySet[g],e.groupKey,g)}}}else{e.nodepos++;var g=e.uidSet[e.nodepos];a(e,e.dhpubkeySet[g],e.groupKey,g)}e.nodepos+1<e.numUsers?setTimeout(function(){e.attempt++,e.mypos<2?e.httpclient.syncKeyNodes(e.userID,e.uidSet[e.nodepos+1],h.util.parseHexString(e.keyNodeSet[e.uidSet[e.nodepos]].toString()),function(a){e.syncKeyNodes(a)}):e.httpclient.syncKeyNodes(e.userID,null,null,function(a){e.syncKeyNodes(a)})},c(e.attempt)*e.keyNodeBackoffSecs):(console.log("All KeyNodes received"),console.log(e.keyNodeSet),b(e)),console.log("done")},h.SafeSlingerExchange.prototype.syncMatchRequest=function(a){var b=this;b.attempt=1,b.numMatch_Recv=1,b.uidSet=[],b.uidSet.push(b.userID),console.log(b.uidSet),b.httpclient.syncMatch(b.userID,b.uidSet,h.util.parseHexString(b.encMatchNonceSet[b.userID].toString()),a)},h.SafeSlingerExchange.prototype.syncMatch=function(a){var b=this;console.log("********************** SafeSlinger syncMatch ************"),console.log(a);var d=(a.ver_server,parseInt(a.match_total),a.match_deltas);console.log(d);var e=d.length;if(b.numMatch_Recv<b.numUsers&&e>0){b.offset=16;for(var f=0;f<e;f++){var i=d[f].usrid;b.uidSet.push(i);var j=CryptoJS.enc.Latin1.parse(atob(d[f].matchnonce_b64));b.encMatchNonceSet[i]=j,console.log(i+"'s encMatchNonce: "+b.encMatchNonceSet[i]),b.numMatch_Recv++,console.log("Received "+b.numMatch_Recv+"/"+b.numUsers+" Items")}}if(b.numMatch_Recv<b.numUsers)setTimeout(function(){b.attempt++,b.httpclient.syncMatch(b.userID,b.uidSet,h.util.parseHexString(b.encMatchNonceSet[b.userID].toString()),function(a){b.syncMatch(a)})},1e3*c(b.attempt));else{console.log("All Match received"),console.log(b.encMatchNonceSet);for(var f=0;f<b.numUsers;f++){var i=b.uidSet[f],k=g(b.encMatchNonceSet[i],b.groupKey);b.matchNonceSet[i]=CryptoJS.enc.Latin1.parse(k.toString(CryptoJS.enc.Latin1).substring(0,32)),console.log(i+"'s Decrypted Match Nonce: "+b.matchNonceSet[i]),console.log(i+"'s matchSigPart: "+CryptoJS.enc.Latin1.parse(b.signatureSet[i].toString(CryptoJS.enc.Latin1).substring(0,32))),console.log(i+"'s matchHash: "+CryptoJS.SHA3(b.matchNonceSet[i],{outputLength:256}));var l=g(b.receivedcipherSet[i],b.matchNonceSet[i]);b.dataSet[i]=CryptoJS.enc.Utf8.stringify(l),console.log(i+"'s Decrypted Data: "+b.dataSet[i])}}console.log("done")},h.SafeSlingerExchange.prototype.getPosition=function(){var a=this;return a.correctSelection},h.SafeSlingerExchange.prototype.getHash24Bits=function(){var a=this;return h.util.parseHexString(a.hash.toString().substring(0,6))},h.SafeSlingerExchange.prototype.getDecoy24Bits1=function(){var a=this;return h.util.parseHexString(a.decoy1.toString().substring(0,6))},h.SafeSlingerExchange.prototype.getDecoy24Bits2=function(){var a=this;return h.util.parseHexString(a.decoy2.toString().substring(0,6))},h.SafeSlingerExchange.prototype.isDataComplete=function(){var a=this,b=Object.keys(a.receivedcipherSet).length>=a.numUsers;return b},h.SafeSlingerExchange.prototype.getDataSet=function(){var a=this;return a.dataSet},h.SafeSlingerExchange.prototype.isMatchComplete=function(){var a=this,b=Object.keys(a.dataSet).length==a.numUsers;return b},h.DiffieHellman=function(){var a=this;a.primeStr="FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA237327FFFFFFFFFFFFFFFF",a.prime=str2bigInt(a.primeStr,16,1536),a.generatorStr="02",a.generator=str2bigInt(a.generatorStr,16,4)},h.DiffieHellman.prototype.genKeys=function(){var a=this;a.privateKey=randBigInt(1536);var b=powMod(a.generator,a.privateKey,a.prime);console.log(bigInt2str(b,16)),a.publicKey=b},h.DiffieHellman.prototype.computeSecret=function(a,b){var c=this,d=powMod(a,b,c.prime);console.log(bigInt2str(d,16));var e=powMod(c.generator,d,c.prime);return console.log(bigInt2str(e,16)),c.publicKey=e,d},h.DiffieHellman.prototype.showParams=function(){var a=this;console.log("Prime: "+bigInt2str(a.prime,16)),console.log("Generator: "+bigInt2str(a.generator,16)),console.log("Private Key: "+bigInt2str(a.privateKey,16)),console.log("Public Key: "+bigInt2str(a.publicKey,16))},h.util={},h.util.parseHexString=function(a){for(var b=[];a.length>=2;)b.push(parseInt(a.substring(0,2),16)),a=a.substring(2,a.length);return b},h.util.createHexString=function(a){for(var b,c="",d=0;d<a.length;d++){var e=a[d].toString(16);b=2-e.length+1,e=Array(b).join("0")+e,c+=e}return c},h.util.createBinString=function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(a[c]);return b},h.util.getNumberPhrase=function(a){return a[0]+1+" "+(a[1]+256+1)+" "+(a[2]+1)},h.util.getWordPhrase=function(a){return i[a[0]]+" "+j[a[1]]+" "+i[a[2]]};var i=["aardvark","absurd","accrue","acme","adrift","adult","afflict","ahead","aimless","Algol","allow","alone","ammo","ancient","apple","artist","assume","Athens","atlas","Aztec","baboon","backfield","backward","banjo","beaming","bedlamp","beehive","beeswax","befriend","Belfast","berserk","billiard","bison","blackjack","blockade","blowtorch","bluebird","bombast","bookshelf","brackish","breadline","breakup","brickyard","briefcase","Burbank","button","buzzard","cement","chairlift","chatter","checkup","chisel","choking","chopper","Christmas","clamshell","classic","classroom","cleanup","clockwork","cobra","commence","concert","cowbell","crackdown","cranky","crowfoot","crucial","crumpled","crusade","cubic","dashboard","deadbolt","deckhand","dogsled","dragnet","drainage","dreadful","drifter","dropper","drumbeat","drunken","Dupont","dwelling","eating","edict","egghead","eightball","endorse","endow","enlist","erase","escape","exceed","eyeglass","eyetooth","facial","fallout","flagpole","flatfoot","flytrap","fracture","framework","freedom","frighten","gazelle","Geiger","glitter","glucose","goggles","goldfish","gremlin","guidance","hamlet","highchair","hockey","indoors","indulge","inverse","involve","island","jawbone","keyboard","kickoff","kiwi","klaxon","locale","lockup","merit","minnow","miser","Mohawk","mural","music","necklace","Neptune","newborn","nightbird","Oakland","obtuse","offload","optic","orca","payday","peachy","pheasant","physique","playhouse","Pluto","preclude","prefer","preshrunk","printer","prowler","pupil","puppy","python","quadrant","quiver","quota","ragtime","ratchet","rebirth","reform","regain","reindeer","rematch","repay","retouch","revenge","reward","rhythm","ribcage","ringbolt","robust","rocker","ruffled","sailboat","sawdust","scallion","scenic","scorecard","Scotland","seabird","select","sentence","shadow","shamrock","showgirl","skullcap","skydive","slingshot","slowdown","snapline","snapshot","snowcap","snowslide","solo","southward","soybean","spaniel","spearhead","spellbind","spheroid","spigot","spindle","spyglass","stagehand","stagnate","stairway","standard","stapler","steamship","sterling","stockman","stopwatch","stormy","sugar","surmount","suspense","sweatband","swelter","tactics","talon","tapeworm","tempest","tiger","tissue","tonic","topmost","tracker","transit","trauma","treadmill","Trojan","trouble","tumor","tunnel","tycoon","uncut","unearth","unwind","uproot","upset","upshot","vapor","village","virus","Vulcan","waffle","wallet","watchword","wayside","willow","woodlark","Zulu"],j=["adroitness","adviser","aftermath","aggregate","alkali","almighty","amulet","amusement","antenna","applicant","Apollo","armistice","article","asteroid","Atlantic","atmosphere","autopsy","Babylon","backwater","barbecue","belowground","bifocals","bodyguard","bookseller","borderline","bottomless","Bradbury","bravado","Brazilian","breakaway","Burlington","businessman","butterfat","Camelot","candidate","cannonball","Capricorn","caravan","caretaker","celebrate","cellulose","certify","chambermaid","Cherokee","Chicago","clergyman","coherence","combustion","commando","company","component","concurrent","confidence","conformist","congregate","consensus","consulting","corporate","corrosion","councilman","crossover","crucifix","cumbersome","customer","Dakota","decadence","December","decimal","designing","detector","detergent","determine","dictator","dinosaur","direction","disable","disbelief","disruptive","distortion","document","embezzle","enchanting","enrollment","enterprise","equation","equipment","escapade","Eskimo","everyday","examine","existence","exodus","fascinate","filament","finicky","forever","fortitude","frequency","gadgetry","Galveston","getaway","glossary","gossamer","graduate","gravity","guitarist","hamburger","Hamilton","handiwork","hazardous","headwaters","hemisphere","hesitate","hideaway","holiness","hurricane","hydraulic","impartial","impetus","inception","indigo","inertia","infancy","inferno","informant","insincere","insurgent","integrate","intention","inventive","Istanbul","Jamaica","Jupiter","leprosy","letterhead","liberty","maritime","matchmaker","maverick","Medusa","megaton","microscope","microwave","midsummer","millionaire","miracle","misnomer","molasses","molecule","Montana","monument","mosquito","narrative","nebula","newsletter","Norwegian","October","Ohio","onlooker","opulent","Orlando","outfielder","Pacific","pandemic","Pandora","paperweight","paragon","paragraph","paramount","passenger","pedigree","Pegasus","penetrate","perceptive","performance","pharmacy","phonetic","photograph","pioneer","pocketful","politeness","positive","potato","processor","provincial","proximate","puberty","publisher","pyramid","quantity","racketeer","rebellion","recipe","recover","repellent","replica","reproduce","resistor","responsive","retraction","retrieval","retrospect","revenue","revival","revolver","sandalwood","sardonic","Saturday","savagery","scavenger","sensation","sociable","souvenir","specialist","speculate","stethoscope","stupendous","supportive","surrender","suspicious","sympathy","tambourine","telephone","therapist","tobacco","tolerance","tomorrow","torpedo","tradition","travesty","trombonist","truncated","typewriter","ultimate","undaunted","underfoot","unicorn","unify","universe","unravel","upcoming","vacancy","vagabond","vertigo","Virginia","visitor","vocalist","voyager","warranty","Waterloo","whimsical","Wichita","Wilmington","Wyoming","yesteryear","Yucatan"];return h}();